#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <stdbool.h>
#include <sys/mman.h>

unsigned char init[] = {0x58, 0xc3, 0x5f, 0xc3, 0x5e, 0xc3, 0x5a, 0xc3, 0x59, 0xc3, 0xc3, 0x48, 0x89, 0x07, 0xc3, 0x48, 0x89, 0xe7, 0xc3, 0x0f, 0x05, 0xc3};

int main(void) {
    char* gadgets = mmap((void*) 0x13370000, 0x1000, PROT_READ | PROT_WRITE, MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
    memcpy(gadgets, init, sizeof(init) / sizeof(init[0]));
    mprotect(gadgets, 0x1000, PROT_READ | PROT_EXEC);
    printf("addr of gadgets: %p\n", gadgets);
    printf("please enter input: ");
    fflush(stdout);
    char buf[64];
    fgets(buf, 0x400, stdin);
    return 0;
}
